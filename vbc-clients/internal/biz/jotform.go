package biz

import (
	"fmt"
	"github.com/go-kratos/kratos/v2/log"
	"github.com/pkg/errors"
	"net/url"
	"vbc/configs"
	"vbc/internal/conf"
	"vbc/lib"
)

/*
https://hipaa-api.jotform.com/submission/6030724015016807379?apiKey=fd2429edf4b4ec4cfed57e7f3b2f09fb

// {"responseCode":200,"message":"success","content":{"id":"6030724015016807379","form_id":"242466899584074","ip":"46.3.240.105","created_at":"2024-09-25 07:20:27","status":"ACTIVE","new":"2","flag":"0","notes":"","updated_at":"2024-09-25 07:32:55","answers":{"1":{"name":"heading","order":"1","text":"VBC Client Intake Form","type":"control_head"},"2":{"name":"submit2","order":"42","text":"Submit","type":"control_button"},"3":{"name":"name","order":"3","sublabels":"{\"prefix\":\"Prefix\",\"first\":\"First Name\",\"middle\":\"Middle Name\",\"last\":\"Last Name\",\"suffix\":\"Suffix\"}","text":"Name","type":"control_fullname","answer":{"first":"acs","last":"ab"},"prettyFormat":"acs ab"},"4":{"maxValue":"","name":"vbcCase","order":"2","text":"VBC Case ID","type":"control_number","answer":"2223"},"5":{"name":"address","order":"4","sublabels":"{\"addr_line1\":\"Street Address\",\"addr_line2\":\"Street Address Line 2\",\"city\":\"City\",\"state\":\"State\",\"postal\":\"Zip Code\",\"country\":\"Country\"}","text":"Address","type":"control_address","answer":{"addr_line1":"c","addr_line2":"2","city":"2","state":"Alaska","postal":"10010"},"prettyFormat":"Street Address: c<br>Street Address Line 2: 2<br>City: 2<br>State: Alaska<br>Zip Code: 10010<br>"},"6":{"countryCode":"No","inputMask":"enable","inputMaskValue":"(###) ###-####","name":"phoneNumber","order":"5","sublabels":"{\"country\":\"Country Code\",\"area\":\"Area Code\",\"phone\":\"Phone Number\",\"full\":\"Phone Number\",\"masked\":\"Please enter a valid phone number.\"}","text":"Phone Number","type":"control_phone","answer":{"full":"(111) 111-1111"},"prettyFormat":"(111) 111-1111"},"10":{"maxValue":"","name":"whatYear","order":"12","text":"What year did you enter service?","type":"control_number","answer":"1860"},"11":{"maxValue":"","name":"whichYear11","order":"13","text":"What year did you separate from service?","type":"control_number","answer":"1990"},"14":{"name":"didYou14","order":"14","text":"Did you serve in World War II? Locations: Various Global Theaters of Operation.","type":"control_radio","answer":"Yes"},"17":{"name":"didYou","order":"18","text":"Did you serve in Korean Peninsula and its surrounding waters?","type":"control_radio","answer":"Yes"},"18":{"name":"typeA","order":"15","text":"Do you have any of these Presumptive Medical Issues for former Prisoners of War?","type":"control_checkbox","answer":["Anxiety","Psychosis","Dysthymic disorder","Organic residuals of frostbite","Post-traumatic osteoarthritis","Heart disease or hypertensive vascular disease","Stroke and residuals of stroke","None of the above"],"prettyFormat":"Anxiety; Psychosis; Dysthymic disorder; Organic residuals of frostbite; Post-traumatic osteoarthritis; Heart disease or hypertensive vascular disease; Stroke and residuals of stroke; None of the above"},"22":{"name":"doYou","order":"19","text":"Do you have this medical condition?","type":"control_radio","answer":"None of the above"},"23":{"name":"didYou23","order":"16","text":"Did you serve in the Early Cold War and Nuclear Testing?","type":"control_radio","answer":"Yes,\u00a0Locations: Hiroshima or Nagasaki, Japan (1945-1946)"},"24":{"name":"doYou24","order":"17","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox","answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above"},"25":{"name":"didYou25","order":"20","text":"Did you serve in Marine Corps Base Camp Lejeune, North Carolina?","type":"control_radio","answer":"Yes"},"26":{"name":"doYou26","order":"21","text":"Do you have any of these Presumptive Medical Issues?","type":"control_checkbox","answer":["Adult leukemia","Aplastic anemia and other myelodysplastic syndromes","Bladder, kidney, and liver cancer","Multiple myeloma","Non-Hodgkin's lymphoma","Parkinson's disease","None of the aboe"],"prettyFormat":"Adult leukemia; Aplastic anemia and other myelodysplastic syndromes; Bladder, kidney, and liver cancer; Multiple myeloma; Non-Hodgkin's lymphoma; Parkinson's disease; None of the aboe"},"27":{"name":"didYou27","order":"22","text":"Did you serve in the Vietnam Era? Locations:\u00a0Vietnam, Thailand, Cambodia, Laos, Korean DMZ?","type":"control_radio","answer":"Yes"},"28":{"name":"doYou28","order":"23","text":"Do you have any of these Presumptive Medical Issues \u00a0(Agent Orange Exposure)?","type":"control_checkbox","answer":["Various cancers (e.g., prostate, respiratory, soft tissue sarcomas)","AL Amyloidosis","Chloracne","Diabetes Mellitus Type 2","Ischemic Heart Disease","Parkinson's disease","Peripheral Neuropathy, Early-Onset","Porphyria Cutanea Tarda","None of the above"],"prettyFormat":"Various cancers (e.g., prostate, respiratory, soft tissue sarcomas); AL Amyloidosis; Chloracne; Diabetes Mellitus Type 2; Ischemic Heart Disease; Parkinson's disease; Peripheral Neuropathy, Early-Onset; Porphyria Cutanea Tarda; None of the above"},"29":{"name":"didYou29","order":"24","text":"Did you serve in Project 112\/SHAD? Locations:\u00a0Various naval vessels and land-based sites?","type":"control_radio","answer":"Yes"},"30":{"name":"ifYes","order":"25","text":"If Yes, No specific presumptive conditions, but eligible for health care benefits","type":"control_textbox","answer":"presumptive conditions Value"},"32":{"name":"didYou32","order":"26","text":"Did you serve in these Additional Radiation Exposure Sites, location: Underground nuclear weapons testing at Amchitka Island, Alaska (1965-1971)?","type":"control_radio","answer":"Yes"},"33":{"name":"didYou33","order":"28","text":"Did you serve in these Additional Radiation Exposure Sites, location: Enewetak Atoll, Marshall Islands cleanup operations (1977-1980)?","type":"control_radio","answer":"Yes"},"34":{"name":"didYou34","order":"30","text":"Did you serve in these Additional Radiation Exposure Sites, location: Nuclear reactor testing in Idaho (1955-1992)?","type":"control_radio","answer":"Yes"},"35":{"name":"didYou35","order":"32","text":"Did you serve in these Additional Radiation Exposure Sites, location: Gaseous diffusion plants in Paducah, KY; Portsmouth, OH; Oak Ridge, TN (1944-1992)?","type":"control_radio","answer":"Yes"},"36":{"name":"doYou36","order":"27","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox","answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above"},"37":{"name":"doYou37","order":"33","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox","answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above"},"38":{"name":"doYou38","order":"29","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox","answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above"},"39":{"name":"doYou39","order":"31","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox","answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above"},"40":{"name":"didYou40","order":"34","text":"Did you serve in Gulf War \/ Southwest Asia Theater? Locations:\u00a0Iraq, Kuwait, Saudi Arabia, Bahrain, Qatar, UAE, Oman, Gulf of Aden, Gulf of Oman, Persian Gulf, Arabian Sea, Red Sea.","type":"control_radio","answer":"Yes"},"41":{"name":"doYou41","order":"35","text":"Do you have any of these Presumptive Medical Issues?","type":"control_checkbox","answer":["Chronic Fatigue Syndrome","Fibromyalgia","Functional gastrointestinal disorders","Undiagnosed illnesses with various symptoms","None of the above"],"prettyFormat":"Chronic Fatigue Syndrome; Fibromyalgia; Functional gastrointestinal disorders; Undiagnosed illnesses with various symptoms; None of the above"},"42":{"name":"didYou42","order":"36","text":"Did you serve Post-9\/11 Conflicts (including PACT Act)? Locations:\u00a0Afghanistan, Djibouti, Egypt, Jordan, Lebanon, Syria, Uzbekistan, Yemen, and others.","type":"control_radio"},"43":{"name":"doYou43","order":"37","text":"Do you have any of these Presumptive Medical Issues?","type":"control_checkbox"},"44":{"name":"didYou44","order":"38","text":"Did you serve in the Ongoing Cold War Era (1945-1991)? Location: Various U.S. military bases and other locations with potential radiation exposure.","type":"control_radio","answer":"Yes"},"45":{"name":"doYou45","order":"39","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox","answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above"},"46":{"name":"didYou46","order":"40","text":"Did you serve in the Ongoing Cold War Era (1945-1991)? Location: Various U.S. and international sites.","type":"control_radio","answer":"Yes"},"47":{"name":"doYou47","order":"41","text":"Do you have any of these Presumptive Medical Issues \u00a0(Agent Orange Exposure)?","type":"control_checkbox","answer":["Various cancers (e.g., prostate, respiratory, soft tissue sarcomas)","AL Amyloidosis","Chloracne","Diabetes Mellitus Type 2","Ischemic Heart Disease","Parkinson's disease","Peripheral Neuropathy, Early-Onset","Porphyria Cutanea Tarda","None of the above"],"prettyFormat":"Various cancers (e.g., prostate, respiratory, soft tissue sarcomas); AL Amyloidosis; Chloracne; Diabetes Mellitus Type 2; Ischemic Heart Disease; Parkinson's disease; Peripheral Neuropathy, Early-Onset; Porphyria Cutanea Tarda; None of the above"},"49":{"name":"ssn49","order":"6","text":"SSN","type":"control_textbox","answer":"111-11-1111"},"50":{"name":"dateOf","order":"7","sublabels":"{\"day\":\"Day\",\"month\":\"Month\",\"year\":\"Year\",\"last\":\"Last Name\",\"hour\":\"Hour\",\"minutes\":\"Minutes\",\"litemode\":\"Date\"}","text":"Date of Birth","timeFormat":"AM\/PM","type":"control_datetime","answer":{"month":"09","day":"04","year":"2024","datetime":"2024-09-04 00:00:00"},"prettyFormat":"09-04-2024"},"51":{"name":"overallRating","order":"8","text":"Overall Rating","type":"control_textbox","answer":"00"},"52":{"name":"branchOf","order":"9","text":"Branch of Service","type":"control_radio","answer":"Marine Coprs"},"54":{"name":"haveYou","order":"10","text":"Have you retired from US Military services?","type":"control_radio","answer":"Yes"},"55":{"name":"areYou","order":"11","text":"Are you currently active duty in the US Military?","type":"control_radio","answer":"Yes"}}},"duration":"174.23ms","info":null,"limit-left":99997}
*/
type JotformUsecase struct {
	log           *log.Helper
	CommonUsecase *CommonUsecase
	conf          *conf.Data
}

func NewJotformUsecase(logger log.Logger,
	CommonUsecase *CommonUsecase,
	conf *conf.Data) *JotformUsecase {
	uc := &JotformUsecase{
		log:           log.NewHelper(logger),
		CommonUsecase: CommonUsecase,
		conf:          conf,
	}

	return uc
}

func (c *JotformUsecase) ApiHost() string {
	return "https://hipaa-api.jotform.com"
}

func (c *JotformUsecase) ApiKey() string {
	return configs.EnvJotformKey()
}

// GetSubmission {"content":{"answers":{"1":{"name":"heading","order":"1","text":"VBC Client Intake Form","type":"control_head"},"10":{"answer":"1980","maxValue":"","name":"whatYear","order":"12","text":"What year did you enter service?","type":"control_number"},"11":{"answer":"2000","maxValue":"","name":"whichYear11","order":"13","text":"What year did you separate from service?","type":"control_number"},"14":{"name":"didYou14","order":"14","text":"Did you serve in World War II? Locations: Various Global Theaters of Operation.","type":"control_radio"},"17":{"name":"didYou","order":"18","text":"Did you serve in Korean Peninsula and its surrounding waters?","type":"control_radio"},"18":{"name":"typeA","order":"15","text":"Do you have any of these Presumptive Medical Issues for former Prisoners of War?","type":"control_checkbox"},"2":{"name":"submit2","order":"42","text":"Submit","type":"control_button"},"22":{"name":"doYou","order":"19","text":"Do you have this medical condition?","type":"control_radio"},"23":{"name":"didYou23","order":"16","text":"Did you serve in the Early Cold War and Nuclear Testing?","type":"control_radio"},"24":{"name":"doYou24","order":"17","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"25":{"answer":"Yes","name":"didYou25","order":"20","text":"Did you serve in Marine Corps Base Camp Lejeune, North Carolina?","type":"control_radio"},"26":{"answer":["Adult leukemia","Aplastic anemia and other myelodysplastic syndromes","Bladder, kidney, and liver cancer","Multiple myeloma","Non-Hodgkin's lymphoma","Parkinson's disease","None of the aboe"],"name":"doYou26","order":"21","prettyFormat":"Adult leukemia; Aplastic anemia and other myelodysplastic syndromes; Bladder, kidney, and liver cancer; Multiple myeloma; Non-Hodgkin's lymphoma; Parkinson's disease; None of the aboe","text":"Do you have any of these Presumptive Medical Issues?","type":"control_checkbox"},"27":{"name":"didYou27","order":"22","text":"Did you serve in the Vietnam Era? Locations: Vietnam, Thailand, Cambodia, Laos, Korean DMZ?","type":"control_radio"},"28":{"name":"doYou28","order":"23","text":"Do you have any of these Presumptive Medical Issues  (Agent Orange Exposure)?","type":"control_checkbox"},"29":{"name":"didYou29","order":"24","text":"Did you serve in Project 112/SHAD? Locations: Various naval vessels and land-based sites?","type":"control_radio"},"3":{"answer":{"first":"fn","last":"ln"},"name":"name","order":"3","prettyFormat":"fn ln","sublabels":"{\"prefix\":\"Prefix\",\"first\":\"First Name\",\"middle\":\"Middle Name\",\"last\":\"Last Name\",\"suffix\":\"Suffix\"}","text":"Name","type":"control_fullname"},"30":{"name":"ifYes","order":"25","text":"If Yes, No specific presumptive conditions, but eligible for health care benefits","type":"control_textbox"},"32":{"name":"didYou32","order":"26","text":"Did you serve in these Additional Radiation Exposure Sites, location: Underground nuclear weapons testing at Amchitka Island, Alaska (1965-1971)?","type":"control_radio"},"33":{"answer":"Yes","name":"didYou33","order":"28","text":"Did you serve in these Additional Radiation Exposure Sites, location: Enewetak Atoll, Marshall Islands cleanup operations (1977-1980)?","type":"control_radio"},"34":{"answer":"Yes","name":"didYou34","order":"30","text":"Did you serve in these Additional Radiation Exposure Sites, location: Nuclear reactor testing in Idaho (1955-1992)?","type":"control_radio"},"35":{"answer":"Yes","name":"didYou35","order":"32","text":"Did you serve in these Additional Radiation Exposure Sites, location: Gaseous diffusion plants in Paducah, KY; Portsmouth, OH; Oak Ridge, TN (1944-1992)?","type":"control_radio"},"36":{"name":"doYou36","order":"27","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"37":{"answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"name":"doYou37","order":"33","prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"38":{"answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"name":"doYou38","order":"29","prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"39":{"answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"name":"doYou39","order":"31","prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"4":{"answer":"1234","maxValue":"","name":"vbcCase","order":"2","text":"VBC Case ID","type":"control_number"},"40":{"answer":"Yes","name":"didYou40","order":"34","text":"Did you serve in Gulf War / Southwest Asia Theater? Locations: Iraq, Kuwait, Saudi Arabia, Bahrain, Qatar, UAE, Oman, Gulf of Aden, Gulf of Oman, Persian Gulf, Arabian Sea, Red Sea.","type":"control_radio"},"41":{"answer":["Chronic Fatigue Syndrome","Fibromyalgia","Functional gastrointestinal disorders","Undiagnosed illnesses with various symptoms","None of the above"],"name":"doYou41","order":"35","prettyFormat":"Chronic Fatigue Syndrome; Fibromyalgia; Functional gastrointestinal disorders; Undiagnosed illnesses with various symptoms; None of the above","text":"Do you have any of these Presumptive Medical Issues?","type":"control_checkbox"},"42":{"name":"didYou42","order":"36","text":"Did you serve Post-9/11 Conflicts (including PACT Act)? Locations: Afghanistan, Djibouti, Egypt, Jordan, Lebanon, Syria, Uzbekistan, Yemen, and others.","type":"control_radio"},"43":{"name":"doYou43","order":"37","text":"Do you have any of these Presumptive Medical Issues?","type":"control_checkbox"},"44":{"answer":"Yes","name":"didYou44","order":"38","text":"Did you serve in the Ongoing Cold War Era (1945-1991)? Location: Various U.S. military bases and other locations with potential radiation exposure.","type":"control_radio"},"45":{"answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"name":"doYou45","order":"39","prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"46":{"answer":"Yes","name":"didYou46","order":"40","text":"Did you serve in the Ongoing Cold War Era (1945-1991)? Location: Various U.S. and international sites.","type":"control_radio"},"47":{"answer":["Various cancers (e.g., prostate, respiratory, soft tissue sarcomas)","AL Amyloidosis","Chloracne","Diabetes Mellitus Type 2","Ischemic Heart Disease","Parkinson's disease","Peripheral Neuropathy, Early-Onset","Porphyria Cutanea Tarda","None of the above"],"name":"doYou47","order":"41","prettyFormat":"Various cancers (e.g., prostate, respiratory, soft tissue sarcomas); AL Amyloidosis; Chloracne; Diabetes Mellitus Type 2; Ischemic Heart Disease; Parkinson's disease; Peripheral Neuropathy, Early-Onset; Porphyria Cutanea Tarda; None of the above","text":"Do you have any of these Presumptive Medical Issues  (Agent Orange Exposure)?","type":"control_checkbox"},"49":{"answer":"123-12-3123","name":"ssn49","order":"6","text":"SSN","type":"control_textbox"},"5":{"answer":{"addr_line1":"addr value333","addr_line2":"aa","city":"city val","postal":"10010","state":"Alabama"},"name":"address","order":"4","prettyFormat":"Street Address: addr value333\u003cbr\u003eStreet Address Line 2: aa\u003cbr\u003eCity: city val\u003cbr\u003eState: Alabama\u003cbr\u003eZip Code: 10010\u003cbr\u003e","sublabels":"{\"addr_line1\":\"Street Address\",\"addr_line2\":\"Street Address Line 2\",\"city\":\"City\",\"state\":\"State\",\"postal\":\"Zip Code\",\"country\":\"Country\"}","text":"Address","type":"control_address"},"50":{"answer":{"datetime":"2024-09-02 00:00:00","day":"02","month":"09","year":"2024"},"name":"dateOf","order":"7","prettyFormat":"09-02-2024","sublabels":"{\"day\":\"Day\",\"month\":\"Month\",\"year\":\"Year\",\"last\":\"Last Name\",\"hour\":\"Hour\",\"minutes\":\"Minutes\",\"litemode\":\"Date\"}","text":"Date of Birth","timeFormat":"AM/PM","type":"control_datetime"},"51":{"answer":"10","name":"overallRating","order":"8","text":"Overall Rating","type":"control_textbox"},"52":{"answer":"Army","name":"branchOf","order":"9","text":"Branch of Service","type":"control_radio"},"54":{"answer":"Yes","name":"haveYou","order":"10","text":"Have you retired from US Military services?","type":"control_radio"},"55":{"answer":"Yes","name":"areYou","order":"11","text":"Are you currently active duty in the US Military?","type":"control_radio"},"6":{"answer":{"full":"(123) 123-1234"},"countryCode":"No","inputMask":"enable","inputMaskValue":"(###) ###-####","name":"phoneNumber","order":"5","prettyFormat":"(123) 123-1234","sublabels":"{\"country\":\"Country Code\",\"area\":\"Area Code\",\"phone\":\"Phone Number\",\"full\":\"Phone Number\",\"masked\":\"Please enter a valid phone number.\"}","text":"Phone Number","type":"control_phone"}},"created_at":"2024-09-25 07:30:17","flag":"0","form_id":"242466899584074","id":"6030730005016019334","ip":"46.3.240.105","new":"2","notes":"","status":"ACTIVE","updated_at":"2024-09-25 07:50:42"},"duration":"179.22ms","info":null,"limit-left":99996,"message":"success","responseCode":200}
func (c *JotformUsecase) GetSubmission(submissionId string) (lib.TypeMap, error) {

	if configs.IsDev() && false {
		str := `{"content":{"answers":{"1":{"name":"heading","order":"1","text":"VBC Client Intake Form","type":"control_head"},"10":{"answer":"1980","maxValue":"","name":"whatYear","order":"12","text":"What year did you enter service?","type":"control_number"},"11":{"answer":"2000","maxValue":"","name":"whichYear11","order":"13","text":"What year did you separate from service?","type":"control_number"},"14":{"name":"didYou14","order":"14","text":"Did you serve in World War II? Locations: Various Global Theaters of Operation.","type":"control_radio"},"17":{"name":"didYou","order":"18","text":"Did you serve in Korean Peninsula and its surrounding waters?","type":"control_radio"},"18":{"name":"typeA","order":"15","text":"Do you have any of these Presumptive Medical Issues for former Prisoners of War?","type":"control_checkbox"},"2":{"name":"submit2","order":"42","text":"Submit","type":"control_button"},"22":{"name":"doYou","order":"19","text":"Do you have this medical condition?","type":"control_radio"},"23":{"name":"didYou23","order":"16","text":"Did you serve in the Early Cold War and Nuclear Testing?","type":"control_radio"},"24":{"name":"doYou24","order":"17","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"25":{"answer":"Yes","name":"didYou25","order":"20","text":"Did you serve in Marine Corps Base Camp Lejeune, North Carolina?","type":"control_radio"},"26":{"answer":["Adult leukemia","Aplastic anemia and other myelodysplastic syndromes","Bladder, kidney, and liver cancer","Multiple myeloma","Non-Hodgkin's lymphoma","Parkinson's disease","None of the aboe"],"name":"doYou26","order":"21","prettyFormat":"Adult leukemia; Aplastic anemia and other myelodysplastic syndromes; Bladder, kidney, and liver cancer; Multiple myeloma; Non-Hodgkin's lymphoma; Parkinson's disease; None of the aboe","text":"Do you have any of these Presumptive Medical Issues?","type":"control_checkbox"},"27":{"name":"didYou27","order":"22","text":"Did you serve in the Vietnam Era? Locations: Vietnam, Thailand, Cambodia, Laos, Korean DMZ?","type":"control_radio"},"28":{"name":"doYou28","order":"23","text":"Do you have any of these Presumptive Medical Issues  (Agent Orange Exposure)?","type":"control_checkbox"},"29":{"name":"didYou29","order":"24","text":"Did you serve in Project 112/SHAD? Locations: Various naval vessels and land-based sites?","type":"control_radio"},"3":{"answer":{"first":"fn","last":"ln"},"name":"name","order":"3","prettyFormat":"fn ln","sublabels":"{\"prefix\":\"Prefix\",\"first\":\"First Name\",\"middle\":\"Middle Name\",\"last\":\"Last Name\",\"suffix\":\"Suffix\"}","text":"Name","type":"control_fullname"},"30":{"name":"ifYes","order":"25","text":"If Yes, No specific presumptive conditions, but eligible for health care benefits","type":"control_textbox"},"32":{"name":"didYou32","order":"26","text":"Did you serve in these Additional Radiation Exposure Sites, location: Underground nuclear weapons testing at Amchitka Island, Alaska (1965-1971)?","type":"control_radio"},"33":{"answer":"Yes","name":"didYou33","order":"28","text":"Did you serve in these Additional Radiation Exposure Sites, location: Enewetak Atoll, Marshall Islands cleanup operations (1977-1980)?","type":"control_radio"},"34":{"answer":"Yes","name":"didYou34","order":"30","text":"Did you serve in these Additional Radiation Exposure Sites, location: Nuclear reactor testing in Idaho (1955-1992)?","type":"control_radio"},"35":{"answer":"Yes","name":"didYou35","order":"32","text":"Did you serve in these Additional Radiation Exposure Sites, location: Gaseous diffusion plants in Paducah, KY; Portsmouth, OH; Oak Ridge, TN (1944-1992)?","type":"control_radio"},"36":{"name":"doYou36","order":"27","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"37":{"answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"name":"doYou37","order":"33","prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"38":{"answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"name":"doYou38","order":"29","prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"39":{"answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"name":"doYou39","order":"31","prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"4":{"answer":"1234","maxValue":"","name":"vbcCase","order":"2","text":"VBC Case ID","type":"control_number"},"40":{"answer":"Yes","name":"didYou40","order":"34","text":"Did you serve in Gulf War / Southwest Asia Theater? Locations: Iraq, Kuwait, Saudi Arabia, Bahrain, Qatar, UAE, Oman, Gulf of Aden, Gulf of Oman, Persian Gulf, Arabian Sea, Red Sea.","type":"control_radio"},"41":{"answer":["Chronic Fatigue Syndrome","Fibromyalgia","Functional gastrointestinal disorders","Undiagnosed illnesses with various symptoms","None of the above"],"name":"doYou41","order":"35","prettyFormat":"Chronic Fatigue Syndrome; Fibromyalgia; Functional gastrointestinal disorders; Undiagnosed illnesses with various symptoms; None of the above","text":"Do you have any of these Presumptive Medical Issues?","type":"control_checkbox"},"42":{"name":"didYou42","order":"36","text":"Did you serve Post-9/11 Conflicts (including PACT Act)? Locations: Afghanistan, Djibouti, Egypt, Jordan, Lebanon, Syria, Uzbekistan, Yemen, and others.","type":"control_radio"},"43":{"name":"doYou43","order":"37","text":"Do you have any of these Presumptive Medical Issues?","type":"control_checkbox"},"44":{"answer":"Yes","name":"didYou44","order":"38","text":"Did you serve in the Ongoing Cold War Era (1945-1991)? Location: Various U.S. military bases and other locations with potential radiation exposure.","type":"control_radio"},"45":{"answer":["Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.)","Multiple myeloma","Lymphomas (other than Hodgkin's disease)","None of the above"],"name":"doYou45","order":"39","prettyFormat":"Various cancers (e.g., leukemia, thyroid, breast, lung, bone, liver, etc.); Multiple myeloma; Lymphomas (other than Hodgkin's disease); None of the above","text":"Do you have any of these Presumptive Medical Issues (Radiation Exposure)?","type":"control_checkbox"},"46":{"answer":"Yes","name":"didYou46","order":"40","text":"Did you serve in the Ongoing Cold War Era (1945-1991)? Location: Various U.S. and international sites.","type":"control_radio"},"47":{"answer":["Various cancers (e.g., prostate, respiratory, soft tissue sarcomas)","AL Amyloidosis","Chloracne","Diabetes Mellitus Type 2","Ischemic Heart Disease","Parkinson's disease","Peripheral Neuropathy, Early-Onset","Porphyria Cutanea Tarda","None of the above"],"name":"doYou47","order":"41","prettyFormat":"Various cancers (e.g., prostate, respiratory, soft tissue sarcomas); AL Amyloidosis; Chloracne; Diabetes Mellitus Type 2; Ischemic Heart Disease; Parkinson's disease; Peripheral Neuropathy, Early-Onset; Porphyria Cutanea Tarda; None of the above","text":"Do you have any of these Presumptive Medical Issues  (Agent Orange Exposure)?","type":"control_checkbox"},"49":{"answer":"123-12-3123","name":"ssn49","order":"6","text":"SSN","type":"control_textbox"},"5":{"answer":{"addr_line1":"addr value333","addr_line2":"aa","city":"city val","postal":"10010","state":"Alabama"},"name":"address","order":"4","prettyFormat":"Street Address: addr value333\u003cbr\u003eStreet Address Line 2: aa\u003cbr\u003eCity: city val\u003cbr\u003eState: Alabama\u003cbr\u003eZip Code: 10010\u003cbr\u003e","sublabels":"{\"addr_line1\":\"Street Address\",\"addr_line2\":\"Street Address Line 2\",\"city\":\"City\",\"state\":\"State\",\"postal\":\"Zip Code\",\"country\":\"Country\"}","text":"Address","type":"control_address"},"50":{"answer":{"datetime":"2024-09-02 00:00:00","day":"02","month":"09","year":"2024"},"name":"dateOf","order":"7","prettyFormat":"09-02-2024","sublabels":"{\"day\":\"Day\",\"month\":\"Month\",\"year\":\"Year\",\"last\":\"Last Name\",\"hour\":\"Hour\",\"minutes\":\"Minutes\",\"litemode\":\"Date\"}","text":"Date of Birth","timeFormat":"AM/PM","type":"control_datetime"},"51":{"answer":"10","name":"overallRating","order":"8","text":"Overall Rating","type":"control_textbox"},"52":{"answer":"Army","name":"branchOf","order":"9","text":"Branch of Service","type":"control_radio"},"54":{"answer":"Yes","name":"haveYou","order":"10","text":"Have you retired from US Military services?","type":"control_radio"},"55":{"answer":"Yes","name":"areYou","order":"11","text":"Are you currently active duty in the US Military?","type":"control_radio"},"6":{"answer":{"full":"(123) 123-1234"},"countryCode":"No","inputMask":"enable","inputMaskValue":"(###) ###-####","name":"phoneNumber","order":"5","prettyFormat":"(123) 123-1234","sublabels":"{\"country\":\"Country Code\",\"area\":\"Area Code\",\"phone\":\"Phone Number\",\"full\":\"Phone Number\",\"masked\":\"Please enter a valid phone number.\"}","text":"Phone Number","type":"control_phone"}},"created_at":"2024-09-25 07:30:17","flag":"0","form_id":"242466899584074","id":"6030730005016019334","ip":"46.3.240.105","new":"2","notes":"","status":"ACTIVE","updated_at":"2024-09-25 07:50:42"},"duration":"179.22ms","info":null,"limit-left":99996,"message":"success","responseCode":200}`
		return lib.ToTypeMapByString(str), nil
	}

	api := fmt.Sprintf("%s/submission/%s", c.ApiHost(), submissionId)
	params := make(url.Values)
	params.Add("apiKey", c.ApiKey())
	res, _, err := lib.RequestGet(api, params, nil)
	if err != nil {
		return nil, err
	}
	if res == nil {
		return nil, errors.New("GetSubmission: res is nil")
	}
	return lib.ToTypeMapByString(*res), nil
}
